

#tags_wrapper{:style=>'float:right;'}
  %h3 Gallery Links
  %div#tags{:style=>'float:right;'}
    != tag_links(max_level = 1, :photos)

- columns = 3
- col = 0

#photo_grid
  %h3
    = params['tag'] ? params['tag'] : 'Photos'
    - if @tag.parent
      &nbsp;
      = link_to 'Up', photos_path(:tag => @tag.parent.name)
  - if current_admin
    %ul#category-photos
      - @tag.children.each do |tag|
        %li{:class => "col-#{col % columns}"}
          - if true #tag.photo
            - html_fragment = capture_haml do
              %div.photo-frame
                .photo-div
                  - if tag.photo
                    = image_tag tag.photo.attachment.url(:medium)
                  - else
                    add thumbnail for:
                    = tag.name
                .caption= tag.name
            = link_to html_fragment, (tag.photo ? photos_path(:tag => tag.name) : tag)
          - col += 1
    %br
  - col = 0
  %ul
    - @photos.each do |photo|
      %li{:class=> "column#{col}"}
        - col < columns-1 ? col += 1 : col = 0
        %div.photo-wrapper
          = link_to image_tag(photo.attachment.url(:medium)), photo.attachment.url, {:class => 'fancybox', :title => "<a href=\"#{photo_path(photo)}\">Order Prints</a>"}
        %div.photo-links
          - if current_admin
            = link_to 'Show', photo_path(photo), :class => 'show'
            = link_to 'Edit', edit_photo_path(photo), :class => 'edit'
            = link_to 'Delete', photo_path(photo), :class => 'delete', :method => :delete, :data => { :confirm => 'Are you sure?' }
          
%div{:style=>'clear:both;'}  
  
= will_paginate @photos, params=>{:order=>params['order']}

%div.scaffold-bottom-links
  - if current_admin  
    = link_to 'New Photo', new_photo_path
    = link_to 'Bulk Photo Upload', '/bulk_upload/new'
